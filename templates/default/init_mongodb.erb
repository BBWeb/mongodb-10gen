limit nofile 20000 20000

kill timeout 300 # wait 300s between SIGTERM and SIGKILL.

pre-start script
#   chown mongodb:mongodb <%= node['mongodb']['data_dir'] %>/<%= node['mongodb'][''] %> <%= node['mongodb']['log_dir'] %>/<%= node['mongodb']['nodename'] %>
end script

start on runlevel [2345]
stop on runlevel [06]

script
  ENABLE_MONGODB="yes"
  PIDFILE=/var/run/<%= node['mongodb']['nodename'] %>.pid
  if [ "x$ENABLE_MONGODB" = "xyes" ]; then exec start-stop-daemon --start --quiet --chuid mongodb -m --pidfile $PIDFILE --exec  /usr/bin/mongod -- --config /data/mongodb/etc/<%= node['mongodb']['nodename'] %>.conf; fi
end script

